<%@page contentType="text/html;charset=GBK" %><%//程序名称：OrphanPolOutInit.jsp//程序功能：//创建日期：2005-05-26 15:39:06//创建人  ：CrtHtml程序创建//更新记录：  更新人    更新日期     更新原因/内容%><!--用户校验类--><%@ page import="com.sinosoft.lis.pubfun.*" %><%@ page import="com.sinosoft.lis.pubfun.GlobalInput" %><%@ page import="com.sinosoft.utility.*" %><%	//init    String tDealNo = new String("");    tDealNo = request.getParameter("DealNo");    if (tDealNo == null || tDealNo == ""         || "undefined".equals(tDealNo) || "null".equals(tDealNo))        tDealNo = PubFun1.CreateMaxNo("AMLDEALNO", 20);    String tCSNM = new String("");    tCSNM = request.getParameter("CSNM");    if (tCSNM==null||tCSNM=="" || "undefined".equals(tCSNM) || "null".equals(tCSNM))        tCSNM = "";    else        tCSNM = new String(request.getParameter("CSNM"));    String tDataState = new String("");    tDataState = request.getParameter("DataState");    if (tDataState==null||tDataState=="" || "undefined".equals(tDataState))        tDataState = "S00";    else        tDataState = new String(request.getParameter("DataState"));    String tOper = new String("");    tOper = request.getParameter("Oper");    if (tOper==null||tOper=="" || "undefined".equals(tOper))        tOper = "All";    else        tOper = new String(request.getParameter("Oper"));            GlobalInput tGI = new GlobalInput();    tGI = (GlobalInput) session.getValue("GI");        String currentDate = PubFun.getCurrentDate();    String currentTime = PubFun.getCurrentTime();%><script language="JavaScript">var tCSNM = '<%=tCSNM%>' ;var tOper = '<%=tOper%>' ; var tDataState = '<%=tDataState%>' ;var cDealNo = '<%=tDealNo%>';function initForm(){	try	{		initInpBox(cDealNo);		initIntBox(cDealNo);		if (fm.all("HTDT").value==null||fm.all("HTDT").value=="")        	fm.all("HTDT").value = '<%=currentDate%>';	    if (fm.all("DealDate").value==null||fm.all("DealDate").value=="")	        fm.all("DealDate").value = '<%=currentDate%>';	    if (fm.all("DealTime").value==null||fm.all("DealTime").value=="")	        fm.all("DealTime").value = '<%=currentTime%>';	    if (tOper == "ViewAndUpdate")	    	document.getElementsByName("finish")[0].disabled = true;	    else 	    	document.getElementsByName("finish")[0].disabled = false;  	}  	catch(re)  	{    	alert("在LXBigTransManualInput.jsp-->InitForm函数中发生异常:初始化界面错误!");  	}}//查询客户信息function initInpBox(cDealNo){	var strSQL = "select DealNo, "			+ "CSNM, "			+ "CTNM, "            + "CITP, "            + "(select codename from ldcode b where codetype = 'amlidtype' and b.code = a.CITP), "            + "CTID, "            + "CTNT, "            + "(select codename from ldcode b where codetype = 'amlcountry' and b.code = a.CTNT), "            + "HTDT, "            + "DataState, "            + "DealDate, "            + "DealTime, "            + "Operator "            + "from LXIHTradeMain a "            + "where 1=1 "  	strSQL = strSQL + "and CSNM = '" + tCSNM + "' ";	if (cDealNo != null && cDealNo != "")		strSQL = strSQL + "and DealNo = '" + cDealNo + "' ";	var strQueryResult  = easyQueryVer3(strSQL, 1, 0, 1);	if (!strQueryResult) {		fm.all("DealNo1").value = cDealNo;		fm.all("Operator").value='<%=tGI.Operator%>';		fm.all("DataState").value = " ";		return true;	}	else{		var arrSelected = decodeEasyQueryResult(strQueryResult);		var i = 0;		fm.all("DealNo1").value=arrSelected[0][i++];		fm.all("CSNM").value=arrSelected[0][i++];		fm.all("CTNM").value=arrSelected[0][i++];		fm.all("CITP").value=arrSelected[0][i++];		fm.all("CITPName").value=arrSelected[0][i++];		fm.all("CTID").value=arrSelected[0][i++];		fm.all("CTNT").value=arrSelected[0][i++];		fm.all("CTNTName").value=arrSelected[0][i++];		fm.all("HTDT").value=arrSelected[0][i++];		fm.all("DataState").value=arrSelected[0][i++];		fm.all("DealDate").value=arrSelected[0][i++];		fm.all("DealTime").value=arrSelected[0][i++];		fm.all("Operator").value=arrSelected[0][i++];		return true;	}}//初始化大额交易明细信息function initIntBox(cDealNo){    initTasksGrid();    var strSQL = "select DealNo, "    		+ "CRCD, "    		+ "TSDT, "    		+ "FINN, "    		+ "CATP, "    		+ "CTAC, "    		+ "TSTM "    		+ "from LXIHTradeDetail "    		+ "where 1=1 "    		+ "and DealNo = '" + cDealNo +"' ";    try{    	turnPage.queryModal(strSQL, TasksGrid, 0, 1 );    }catch(ex){alert(ex);}}// 大额交易信息function initTasksGrid(){    var iArray = new Array();    try    {        iArray[0]=new Array();        iArray[0][0]="序号";        iArray[0][1]="30px";        iArray[0][2]=30;        iArray[0][3]=0;        iArray[1]=new Array();        iArray[1][0]="交易编号";        iArray[1][1]="150px";        iArray[1][2]=100;        iArray[1][3]=0;        iArray[2]=new Array();        iArray[2][0]="大额交易特征代码";        iArray[2][1]="100px";        iArray[2][2]=100;        iArray[2][3]=2;		iArray[2][4]="amlbigstamp";                 		iArray[2][9]="大额交易特征代码|Code:amlbigstamp"; 	                iArray[3]=new Array();        iArray[3][0]="大额交易明细编码";        iArray[3][1]="100px";        iArray[3][2]=100;        iArray[3][3]=0;        iArray[4]=new Array();        iArray[4][0]="金融机构网点名称";        iArray[4][1]="120px";        iArray[4][2]=100;        iArray[4][3]=0;        iArray[5]=new Array();        iArray[5][0]="账户类型";        iArray[5][1]="80px";        iArray[5][2]=100;        iArray[5][3]=2;		iArray[5][4]="amlaccount";                 		iArray[5][9]="账户类型|Code:amlaccount"; 	                                iArray[6]=new Array();        iArray[6][0]="账号";        iArray[6][1]="100px";        iArray[6][2]=150;        iArray[6][3]=0;        iArray[7]=new Array();        iArray[7][0]="交易时间";        iArray[7][1]="100px";        iArray[7][2]=200;        iArray[7][3]=0;        TasksGrid = new MulLineEnter( "fm" , "TasksGrid" );        //这些属性必须在loadMulLine前        TasksGrid.displayTitle = 1;        TasksGrid.locked = 1;        TasksGrid.hiddenPlus = 1;        TasksGrid.hiddenSubtraction = 1;        TasksGrid.canSel = 1;        TasksGrid.loadMulLine(iArray);    }    catch(ex)    {      alert(ex);    }}</script>